<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ez="jakarta.faces.composite/ezcomp">

    <h:head>
        <title>KraQus</title>
    </h:head>

    <h:body>
        <f:view>
            <h:form>
                <ez:globalMenu/>
            </h:form>

            <h:form id="form1">

                <p:blockUI block="form1" trigger="chkBtn1, chkBtn2, chkBtn3, chkBtn4, csvBtn, runAllBtn">
                    <p:graphicImage value="/ajax-loader.gif" />
                </p:blockUI>  

                <p:messages id="msgs" showDetail="false" >
                    <p:autoUpdate />
                </p:messages>   
                
                <p:panelGrid columns="10" layout="tabular" id="runPanel">
                    <p:commandButton value="Run All + Profit" action="#{learnPairBean.onRunAllProfit()}"
                                     id="runAllBtn" update="tbl, runPanel" title="Run All + Calculate profit"/>                    

                    <p:outputLabel value="Profit: This Year:"/>  
                    <p:outputLabel value="#{learnPairBean.profitThisYear}"/>  
                    
                    <p:outputLabel value="Profit: Last Year:"/>
                    <p:outputLabel value="#{learnPairBean.profitLastYear}"/>  
                    
                    
                    <p:commandButton value="Generate" action="#{learnPairBean.onGenerate()}"
                                     id="chkBtn1" update="tbl" title="Generate learnPairs"/>


                    <p:commandButton value="Bests" action="#{learnPairBean.onBestLearns()}"
                                     id="chkBtn2" update="tbl" title="Seek Best learns"/>
                    
                    <p:commandButton value="Save" action="#{learnPairBean.onSaveLearn()}"
                                     id="chkBtn3" update="tbl" title="Save as learn"/>

                    <p:commandButton value="RunAll" action="#{learnPairBean.onRunAll()}"
                                     id="chkBtn4" update="tbl" title="Save as learn"/>

                    <p:commandButton value="toCSV" id="csvBtn"
                                     actionListener="#{learnPairBean.onCSVExport()}"
                                     onclick="PrimeFaces.monitorDownload(start, stop);"
                                     ajax="true">
                        <p:fileDownload value="#{learnPairBean.file}" />
                    </p:commandButton>                     
                    
                    
                </p:panelGrid>                

                <p:panelGrid columns="6" layout="tabular">
                    <p:outputLabel value="Scope:"/>  
                    <p:spinner value="#{learnPairBean.scope}"
                               id="scope" min="1"/>


                    <p:outputLabel value="MinProfit%:"/>  
                    <p:spinner value="#{learnPairBean.minProfit}"
                               id="minProfit" min="1"/>


                    <p:outputLabel value="Learn:"/>  
                    <p:autoComplete value="#{learnPairBean.selectedLearnName}"
                                    completeMethod="#{learnPairBean.complete}">
                    </p:autoComplete>


                </p:panelGrid>

                <p:panel>
                    <p:dataTable value="#{learnPairBean.learnList}" var="item" tableStyle="width:auto" id="tbl">
                        <p:column headerText="buyDate">
                            <p:commandLink value="#{item.buyDate}"/>
                        </p:column>

                        <p:column headerText="buyClose">
                            <p:outputLabel value="#{item.buyClose}"/>
                        </p:column>      

                        <p:column headerText="sellDate">
                            <p:commandLink value="#{item.sellDate}"/>
                        </p:column>

                        <p:column headerText="sellClose">
                            <p:outputLabel value="#{item.sellClose}"/>
                        </p:column>                              

                        <p:column headerText="profit">
                            <p:outputLabel value="#{item.profit}"/>
                        </p:column>     

                        <p:column headerText="learn">
                            <p:outputLabel value="#{item.learn}" />
                        </p:column>
                    </p:dataTable>
                </p:panel>                    
            </h:form>
        </f:view>
    </h:body>
</html>
